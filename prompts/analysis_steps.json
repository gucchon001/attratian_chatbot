{
  "step1_keyword_extraction": {
    "gemini_conservative_extraction": {
      "description": "Gemini AIによる保守的キーワード抽出プロンプト（v3.0）",
      "prompt": "あなたはCLIENTTOMOプロジェクト専用のキーワード抽出AIです。\nユーザーの入力意図に忠実で、過度な拡張を避けた保守的な抽出を実行してください。\n\n入力クエリ: \"{user_query}\"\n\n## 保守的抽出ルール（v3.0）:\n\n### 1. 入力文字列重視の原則\n- ユーザーが明示的に記載した語句を最優先\n- 「ログイン機能」→ [ログイン機能, ログイン] （認証やパスワードは追加しない）\n- 「会員登録」→ [会員登録, 会員, 登録] （アカウントは入力にない場合追加しない）\n\n### 2. 厳格な拡張制限\n以下の場合のみ関連語を追加:\n- 入力に「機能」があり、その機能に必須の技術用語のみ\n- 入力に略語がある場合の正式名称（UI→ユーザーインターフェース）\n- 表記ゆれの統一（DB→データベース）\n\n### 3. 禁止する過度な拡張\n以下は入力に明記されていない限り追加禁止:\n- 認証系の自動拡張（ログイン→認証、パスワード、セッション）\n- 周辺機能の推測追加\n- 技術詳細の先回り追加\n\n### 4. 除外処理（継続）\n以下は厳格に除去:\n- 汎用動詞: 教えて、確認、調べて、見つけて、探して、検索して\n- 汎用助詞: について、に関する、の件、の内容、の詳細  \n- 汎用名詞: 情報、データ、内容、詳細、状況、方法、仕様、機能、システム、フロー、設計\n\n### 5. 複合語分解ルール\n複合語は具体的な部分を抽出:\n- 「ログイン機能」→ [ログイン機能, ログイン] （「機能」は汎用語なので除外）\n- 「API設計」→ [API設計, API] （「設計」は汎用語なので除外）\n- 「会員登録」→ [会員登録, 会員, 登録]\n\n### 6. 最大2-3キーワード原則\n保守的抽出により、通常2-3個のキーワードで十分な検索精度を実現:\n1. 主要キーワード（入力の核心語句）\n2. 機能キーワード（入力に「機能」がある場合）\n3. 必要最小限の補完（明確な略語展開のみ）\n\n## 出力形式:\n{{\n  \"keywords\": [\"抽出されたキーワード1\", \"抽出されたキーワード2\"],\n  \"confidence\": 0.0から1.0の数値,\n  \"extraction_method\": \"gemini_conservative_v3\",\n  \"reasoning\": \"抽出理由の簡潔な説明\"\n}}",
      "parameters": ["user_query"],
      "version": "3.0"
    }
  },
  "step2_datasource_judgment": {
    "keyword_optimization": {
      "description": "検索用キーワード最適化プロンプト",
      "prompt": "検索用キーワード最適化を行ってください。\n\n元のキーワード: {keywords}\n選択されたデータソース: {selected_datasources}\n\n## 最適化ルール（仕様書準拠）:\n\n### 1. 判定専用語の除去\n以下の判定専用語は検索には不要なので除去してください:\n- 仕様, 詳細, 機能, チケット, 進捗, 議事録\n\n### 2. 汎用句の除去  \n検索精度を下げる汎用表現を除去:\n- 動詞: 教えて, 説明して, 整理して, 抽出して, 確認して\n\n### 3. 重要語の抽出\n検索に有効な具体的キーワードのみ抽出してください。\n\n最適化されたキーワードをJSON形式で出力:\n{{\"optimized_keywords\": [\"キーワード1\", \"キーワード2\", \"キーワード3\"]}}",
      "parameters": ["keywords", "selected_datasources"],
      "version": "1.0"
    },
    "datasource_confidence_judgment": {
      "description": "データソース選択信頼度判定プロンプト",
      "prompt": "以下のキーワードと検索意図に基づいて、最適なデータソース（Jira/Confluence）を判定してください。\n\nキーワード: {keywords}\n検索意図: {search_intent}\n\n## 判定基準:\n\n### Confluence優位パターン:\n- 仕様書、設計書、ドキュメント系\n- 機能説明、システム構成\n- プロセス、手順、ガイドライン\n\n### Jira優位パターン:\n- 特定チケット番号の参照\n- バグ報告、課題管理\n- 進捗状況、ワークフロー\n\n### ハイブリッドパターン:\n- 仕様とバグの関連調査\n- 実装状況の確認\n\n## 出力形式:\n{{\n  \"confluence_confidence\": 0.0から1.0,\n  \"jira_confidence\": 0.0から1.0,\n  \"reasoning\": \"判定理由\",\n  \"recommended_strategy\": \"confluence_first|jira_first|parallel\"\n}}",
      "parameters": ["keywords", "search_intent"],
      "version": "1.0"
    }
  }
} 