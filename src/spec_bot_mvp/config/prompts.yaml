# 仕様書作成支援ボット - プロンプト設定
# このファイルでエージェントの応答品質をチューニングできます

# エージェント関連プロンプト
agent:
  # システムメッセージ - エージェントの基本性格と役割
  system_message: |
    あなたは「仕様書作成支援ボット」です。JiraとConfluenceから情報を検索し、詳細に分析して回答します。

    【重要】以下のフォーマットを厳密に守ってください：
    - Thought: で考えを述べる
    - Action: でツール名を指定
    - Action Input: で検索キーワードを指定
    - Observation: でツール結果を確認
    - Final Answer: で最終回答を提示

    【応答品質】
    ✅ 検索結果から具体的な内容を抽出
    ✅ 重要ポイントを📌で強調
    ✅ 実用的な洞察と推奨事項を提供
    ✅ リンクや参照元を含める

  # ReActテンプレート - 思考プロセスの指導
  react_template: |
    利用可能なツール:
    {tools}

    以下のフォーマットを厳密に守って回答してください：

    Question: {input}
    
    Thought: ユーザーの質問を分析し、必要なツールと検索戦略を決定する
    Action: {tool_names}
    Action Input: 検索キーワード
    Observation: ツールからの結果
    Thought: 必要な情報が十分に得られた場合は、最終回答を生成する。不足している場合のみ追加検索を行う。
    Final Answer: ユーザーの質問に対する詳細で実用的な回答。検索結果から得られた具体的な情報を含める。

    重要: 検索で情報が見つかった場合は、必ず詳細な Final Answer を提供すること。

    {agent_scratchpad}

# ツール説明文 - LLMがツールを適切に選択できるよう最適化
tools:
  jira_search:
    name: "jira_search"
    description: |
      🎯 Jiraチケットをキーワードで検索し、詳細な情報を取得します。
      
      【使用場面】
      ・「○○のバグを探して」「進捗を確認したい」
      ・「ログイン機能のチケット」「UIに関するタスク」
      ・「担当者のチケット一覧」「プロジェクトの状況」
      
      【入力】ユーザーの質問から抽出した検索キーワード（日本語OK）
      【出力】関連チケットの詳細情報（タイトル、ステータス、担当者、説明、リンク付き）
      
      【重要】検索結果は件数だけでなく、各チケットの内容を分析して具体的な情報を抽出すること

  confluence_search:
    name: "confluence_search"
    description: |
      📚 Confluenceドキュメントをキーワードで検索し、内容を詳細分析します。
      
      【使用場面】
      ・「仕様書を探して」「設計書を見たい」
      ・「議事録を確認したい」「○○の手順書」
      ・「技術文書」「マニュアル」「プロジェクト資料」
      ・「最適な○○について」「ベストプラクティス」
      
      【入力】ユーザーの質問から抽出した検索キーワード（日本語OK）
      【出力】関連ページの詳細内容（タイトル、概要、重要ポイント、リンク付き）
      
      【重要】検索結果から具体的な技術情報、実装方法、設計思想等を抽出して説明すること

  jira_filter_options:
    name: "jira_filter_options"
    description: |
      📋 Jiraで利用可能なフィルター項目一覧を取得します。
      
      【使用場面】
      ・「どんなプロジェクトがある？」
      ・「利用可能なステータスを教えて」
      ・「担当者一覧を見たい」
      ・フィルター検索の前準備
      
      【入力】不要（空文字列でOK）
      【出力】プロジェクト、ステータス、担当者などの選択肢一覧

  jira_filtered_search:
    name: "jira_filtered_search"
    description: |
      🔍 詳細条件でJiraチケットを絞り込み検索します。
      
      【使用場面】
      ・「CTJプロジェクトの完了済みタスク」
      ・「高優先度のバグ一覧」
      ・「○○さん担当の進行中チケット」
      ・「今月作成されたチケット」
      
      【入力】検索キーワード（条件は自動で抽出されます）
      【出力】フィルター条件に一致するチケット一覧

  confluence_filtered_search:
    name: "confluence_filtered_search"
    description: |
      🔍 詳細条件でConfluenceページを絞り込み検索します。
      
      【使用場面】
      ・「特定スペースの仕様書」
      ・「今月更新されたドキュメント」
      ・「特定タイプのページのみ」
      
      【入力】検索キーワード（条件は自動で抽出されます）
      【出力】フィルター条件に一致するページ一覧

  confluence_space_structure:
    name: "confluence_space_structure"
    description: |
      🏗️ Confluenceスペースの全体構造を把握します。
      
      【使用場面】
      ・「どんなドキュメントがあるかざっと知りたい」
      ・「スペースの構造を確認したい」
      ・「ページの階層を理解したい」
      
      【入力】スペースキー（通常は'CLIENTTOMO'）
      【出力】スペース内のページ構造と統計情報

# UI関連メッセージ
ui:
  welcome_message: |
    🤖 こんにちは！仕様書作成支援ボットです

    JiraとConfluenceから必要な情報をすぐに見つけてお答えします。
    以下のような質問をお気軽にどうぞ：

    💡 「ログイン機能の仕様書を探して」
    💡 「UIバグの進捗を教えて」  
    💡 「今月のタスク一覧を見せて」
    💡 「設計書を検索したい」

  processing_message: "🔍 {sources}から「{query}」について検索中です..."
  no_results_message: |
    😅 関連する情報が見つかりませんでした。

    💡 別のキーワードで試してみてください：
    ・より具体的な用語（例：「ログイン」→「認証機能」）
    ・類義語や英語（例：「バグ」→「Bug」「不具合」）
    ・プロジェクト名やチケット番号

  error_message: |
    ❌ 処理中にエラーが発生しました。

    🔄 以下をお試しください：
    ・少し時間をおいてから再実行
    ・シンプルなキーワードで検索
    ・管理者にお問い合わせ

# 応答フォーマットテンプレート
response_templates:
  jira_results: |
    🎯 **Jiraチケット検索結果**

    📌 **見つかったチケット：{count}件**

    {results}

    💡 **分析結果**：チケットの内容から読み取れる重要なポイント
    💡 **推奨アクション**：これらの情報を基にした次のステップ
    💡 **参考**：より詳細な情報は各チケットのリンクからご確認ください。

  confluence_results: |
    📚 **Confluenceページ検索結果**

    📌 **見つかったページ：{count}件**

    {results}

    💡 **重要なポイント**：ドキュメントから抽出した主要な情報
    💡 **実践的な洞察**：これらの情報から得られる知見
    💡 **参考**：より詳細な情報は各ページのリンクからご確認ください。

  combined_results: |
    🔍 **統合検索結果**

    {jira_section}
    
    {confluence_section}

    📊 **総合分析**：JiraとConfluenceの情報を統合した包括的な見解
    💡 **推奨事項**：これらの情報に基づく具体的な提案
    💡 **次のステップ**：特定の情報についてより詳しく知りたい場合は、お気軽にお聞きください。

# エラーハンドリング
error_handling:
  api_connection_error: |
    🔌 外部サービスへの接続に失敗しました。
    ネットワーク接続とAPI設定を確認してください。

  authentication_error: |
    🔐 認証に失敗しました。
    APIトークンと権限設定を確認してください。

  timeout_error: |
    ⏰ 処理がタイムアウトしました。
    検索条件を絞って再試行してください。

  general_error: |
    ❌ 予期しないエラーが発生しました。
    管理者にお問い合わせください。 